import{u as se}from"./chunk-M3VFKDXJ-CBn0_yhP.js";import{u as st}from"./chunk-PFKKVLZX-03RQAOan.js";import{bO as R,bP as rt,bQ as be,bR as re,bS as nt,bT as it,r as _,b as H,ab as Ge,j as s,au as K,bU as Ue,B as lt,bV as q,ax as J,o as O,az as Z,bW as le,G as z,bX as xe,bY as ze,J as X,z as Q,bZ as U,M as He,b_ as ot,av as ut}from"./index-BfncdA6x.js";import{_ as me,a as Ke,b as qe,e as ct,i as he,c as dt,d as ft,f as ne,g as gt}from"./_isIndex-CeB21s9u.js";import{R as pt,I as vt,a as bt}from"./index-BxvhuQcQ.js";var mt=me;function ht(){this.__data__=new mt,this.size=0}var xt=ht;function yt(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a}var _t=yt;function jt(e){return this.__data__.get(e)}var $t=jt;function Tt(e){return this.__data__.has(e)}var wt=Tt,At=me,St=Ke,Ot=qe,Nt=200;function Ct(e,t){var a=this.__data__;if(a instanceof At){var r=a.__data__;if(!St||r.length<Nt-1)return r.push([e,t]),this.size=++a.size,this;a=this.__data__=new Ot(r)}return a.set(e,t),this.size=a.size,this}var Pt=Ct,Et=me,Dt=xt,It=_t,Mt=$t,Ft=wt,Lt=Pt;function k(e){var t=this.__data__=new Et(e);this.size=t.size}k.prototype.clear=Dt;k.prototype.delete=It;k.prototype.get=Mt;k.prototype.has=Ft;k.prototype.set=Lt;var Rt=k,kt="__lodash_hash_undefined__";function Vt(e){return this.__data__.set(e,kt),this}var Bt=Vt;function Gt(e){return this.__data__.has(e)}var Ut=Gt,zt=qe,Ht=Bt,Kt=Ut;function ee(e){var t=-1,a=e==null?0:e.length;for(this.__data__=new zt;++t<a;)this.add(e[t])}ee.prototype.add=ee.prototype.push=Ht;ee.prototype.has=Kt;var qt=ee;function Jt(e,t){for(var a=-1,r=e==null?0:e.length;++a<r;)if(t(e[a],a,e))return!0;return!1}var Wt=Jt;function Yt(e,t){return e.has(t)}var Xt=Yt,Qt=qt,Zt=Wt,ea=Xt,ta=1,aa=2;function sa(e,t,a,r,i,n){var u=a&ta,o=e.length,d=t.length;if(o!=d&&!(u&&d>o))return!1;var c=n.get(e),f=n.get(t);if(c&&f)return c==t&&f==e;var v=-1,m=!0,T=a&aa?new Qt:void 0;for(n.set(e,t),n.set(t,e);++v<o;){var l=e[v],p=t[v];if(r)var y=u?r(p,l,v,t,e,n):r(l,p,v,e,t,n);if(y!==void 0){if(y)continue;m=!1;break}if(T){if(!Zt(t,function(b,h){if(!ea(T,h)&&(l===b||i(l,b,a,r,n)))return T.push(h)})){m=!1;break}}else if(!(l===p||i(l,p,a,r,n))){m=!1;break}}return n.delete(e),n.delete(t),m}var Je=sa,ra=R,na=ra.Uint8Array,ia=na;function la(e){var t=-1,a=Array(e.size);return e.forEach(function(r,i){a[++t]=[i,r]}),a}var oa=la;function ua(e){var t=-1,a=Array(e.size);return e.forEach(function(r){a[++t]=r}),a}var ca=ua,ye=rt,_e=ia,da=ct,fa=Je,ga=oa,pa=ca,va=1,ba=2,ma="[object Boolean]",ha="[object Date]",xa="[object Error]",ya="[object Map]",_a="[object Number]",ja="[object RegExp]",$a="[object Set]",Ta="[object String]",wa="[object Symbol]",Aa="[object ArrayBuffer]",Sa="[object DataView]",je=ye?ye.prototype:void 0,oe=je?je.valueOf:void 0;function Oa(e,t,a,r,i,n,u){switch(a){case Sa:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Aa:return!(e.byteLength!=t.byteLength||!n(new _e(e),new _e(t)));case ma:case ha:case _a:return da(+e,+t);case xa:return e.name==t.name&&e.message==t.message;case ja:case Ta:return e==t+"";case ya:var o=ga;case $a:var d=r&va;if(o||(o=pa),e.size!=t.size&&!d)return!1;var c=u.get(e);if(c)return c==t;r|=ba,u.set(e,t);var f=fa(o(e),o(t),r,i,n,u);return u.delete(e),f;case wa:if(oe)return oe.call(e)==oe.call(t)}return!1}var Na=Oa;function Ca(e,t){for(var a=-1,r=t.length,i=e.length;++a<r;)e[i+a]=t[a];return e}var Pa=Ca,Ea=Pa,Da=he;function Ia(e,t,a){var r=t(e);return Da(e)?r:Ea(r,a(e))}var Ma=Ia;function Fa(e,t){for(var a=-1,r=e==null?0:e.length,i=0,n=[];++a<r;){var u=e[a];t(u,a,e)&&(n[i++]=u)}return n}var La=Fa;function Ra(){return[]}var ka=Ra,Va=La,Ba=ka,Ga=Object.prototype,Ua=Ga.propertyIsEnumerable,$e=Object.getOwnPropertySymbols,za=$e?function(e){return e==null?[]:(e=Object(e),Va($e(e),function(t){return Ua.call(e,t)}))}:Ba,Ha=za;function Ka(e,t){for(var a=-1,r=Array(e);++a<e;)r[a]=t(a);return r}var qa=Ka,Ja=be,Wa=re,Ya="[object Arguments]";function Xa(e){return Wa(e)&&Ja(e)==Ya}var Qa=Xa,Te=Qa,Za=re,We=Object.prototype,es=We.hasOwnProperty,ts=We.propertyIsEnumerable,as=Te(function(){return arguments}())?Te:function(e){return Za(e)&&es.call(e,"callee")&&!ts.call(e,"callee")},ss=as,te={exports:{}};function rs(){return!1}var ns=rs;te.exports;(function(e,t){var a=R,r=ns,i=t&&!t.nodeType&&t,n=i&&!0&&e&&!e.nodeType&&e,u=n&&n.exports===i,o=u?a.Buffer:void 0,d=o?o.isBuffer:void 0,c=d||r;e.exports=c})(te,te.exports);var Ye=te.exports,is=9007199254740991;function ls(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=is}var Xe=ls,os=be,us=Xe,cs=re,ds="[object Arguments]",fs="[object Array]",gs="[object Boolean]",ps="[object Date]",vs="[object Error]",bs="[object Function]",ms="[object Map]",hs="[object Number]",xs="[object Object]",ys="[object RegExp]",_s="[object Set]",js="[object String]",$s="[object WeakMap]",Ts="[object ArrayBuffer]",ws="[object DataView]",As="[object Float32Array]",Ss="[object Float64Array]",Os="[object Int8Array]",Ns="[object Int16Array]",Cs="[object Int32Array]",Ps="[object Uint8Array]",Es="[object Uint8ClampedArray]",Ds="[object Uint16Array]",Is="[object Uint32Array]",j={};j[As]=j[Ss]=j[Os]=j[Ns]=j[Cs]=j[Ps]=j[Es]=j[Ds]=j[Is]=!0;j[ds]=j[fs]=j[Ts]=j[gs]=j[ws]=j[ps]=j[vs]=j[bs]=j[ms]=j[hs]=j[xs]=j[ys]=j[_s]=j[js]=j[$s]=!1;function Ms(e){return cs(e)&&us(e.length)&&!!j[os(e)]}var Fs=Ms;function Ls(e){return function(t){return e(t)}}var Rs=Ls,ae={exports:{}};ae.exports;(function(e,t){var a=nt,r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,n=i&&i.exports===r,u=n&&a.process,o=function(){try{var d=i&&i.require&&i.require("util").types;return d||u&&u.binding&&u.binding("util")}catch{}}();e.exports=o})(ae,ae.exports);var ks=ae.exports,Vs=Fs,Bs=Rs,we=ks,Ae=we&&we.isTypedArray,Gs=Ae?Bs(Ae):Vs,Qe=Gs,Us=qa,zs=ss,Hs=he,Ks=Ye,qs=dt,Js=Qe,Ws=Object.prototype,Ys=Ws.hasOwnProperty;function Xs(e,t){var a=Hs(e),r=!a&&zs(e),i=!a&&!r&&Ks(e),n=!a&&!r&&!i&&Js(e),u=a||r||i||n,o=u?Us(e.length,String):[],d=o.length;for(var c in e)(t||Ys.call(e,c))&&!(u&&(c=="length"||i&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||qs(c,d)))&&o.push(c);return o}var Qs=Xs,Zs=Object.prototype;function er(e){var t=e&&e.constructor,a=typeof t=="function"&&t.prototype||Zs;return e===a}var tr=er;function ar(e,t){return function(a){return e(t(a))}}var sr=ar,rr=sr,nr=rr(Object.keys,Object),ir=nr,lr=tr,or=ir,ur=Object.prototype,cr=ur.hasOwnProperty;function dr(e){if(!lr(e))return or(e);var t=[];for(var a in Object(e))cr.call(e,a)&&a!="constructor"&&t.push(a);return t}var fr=dr,gr=ft,pr=Xe;function vr(e){return e!=null&&pr(e.length)&&!gr(e)}var br=vr,mr=Qs,hr=fr,xr=br;function yr(e){return xr(e)?mr(e):hr(e)}var _r=yr,jr=Ma,$r=Ha,Tr=_r;function wr(e){return jr(e,Tr,$r)}var Ar=wr,Se=Ar,Sr=1,Or=Object.prototype,Nr=Or.hasOwnProperty;function Cr(e,t,a,r,i,n){var u=a&Sr,o=Se(e),d=o.length,c=Se(t),f=c.length;if(d!=f&&!u)return!1;for(var v=d;v--;){var m=o[v];if(!(u?m in t:Nr.call(t,m)))return!1}var T=n.get(e),l=n.get(t);if(T&&l)return T==t&&l==e;var p=!0;n.set(e,t),n.set(t,e);for(var y=u;++v<d;){m=o[v];var b=e[m],h=t[m];if(r)var w=u?r(h,b,m,t,e,n):r(b,h,m,e,t,n);if(!(w===void 0?b===h||i(b,h,a,r,n):w)){p=!1;break}y||(y=m=="constructor")}if(p&&!y){var A=e.constructor,C=t.constructor;A!=C&&"constructor"in e&&"constructor"in t&&!(typeof A=="function"&&A instanceof A&&typeof C=="function"&&C instanceof C)&&(p=!1)}return n.delete(e),n.delete(t),p}var Pr=Cr,Er=ne,Dr=R,Ir=Er(Dr,"DataView"),Mr=Ir,Fr=ne,Lr=R,Rr=Fr(Lr,"Promise"),kr=Rr,Vr=ne,Br=R,Gr=Vr(Br,"Set"),Ur=Gr,zr=ne,Hr=R,Kr=zr(Hr,"WeakMap"),qr=Kr,de=Mr,fe=Ke,ge=kr,pe=Ur,ve=qr,Ze=be,V=gt,Oe="[object Map]",Jr="[object Object]",Ne="[object Promise]",Ce="[object Set]",Pe="[object WeakMap]",Ee="[object DataView]",Wr=V(de),Yr=V(fe),Xr=V(ge),Qr=V(pe),Zr=V(ve),I=Ze;(de&&I(new de(new ArrayBuffer(1)))!=Ee||fe&&I(new fe)!=Oe||ge&&I(ge.resolve())!=Ne||pe&&I(new pe)!=Ce||ve&&I(new ve)!=Pe)&&(I=function(e){var t=Ze(e),a=t==Jr?e.constructor:void 0,r=a?V(a):"";if(r)switch(r){case Wr:return Ee;case Yr:return Oe;case Xr:return Ne;case Qr:return Ce;case Zr:return Pe}return t});var en=I,ue=Rt,tn=Je,an=Na,sn=Pr,De=en,Ie=he,Me=Ye,rn=Qe,nn=1,Fe="[object Arguments]",Le="[object Array]",Y="[object Object]",ln=Object.prototype,Re=ln.hasOwnProperty;function on(e,t,a,r,i,n){var u=Ie(e),o=Ie(t),d=u?Le:De(e),c=o?Le:De(t);d=d==Fe?Y:d,c=c==Fe?Y:c;var f=d==Y,v=c==Y,m=d==c;if(m&&Me(e)){if(!Me(t))return!1;u=!0,f=!1}if(m&&!f)return n||(n=new ue),u||rn(e)?tn(e,t,a,r,i,n):an(e,t,d,a,r,i,n);if(!(a&nn)){var T=f&&Re.call(e,"__wrapped__"),l=v&&Re.call(t,"__wrapped__");if(T||l){var p=T?e.value():e,y=l?t.value():t;return n||(n=new ue),i(p,y,a,r,n)}}return m?(n||(n=new ue),sn(e,t,a,r,i,n)):!1}var un=on,cn=un,ke=re;function et(e,t,a,r,i){return e===t?!0:e==null||t==null||!ke(e)&&!ke(t)?e!==e&&t!==t:cn(e,t,a,r,et,i)}var dn=et,fn=dn;function gn(e,t){return fn(e,t)}var pn=gn;const vn=it(pn);var tt=_.createContext(null),W=()=>{const e=_.useContext(tt);if(!e)throw new Error("useDataTableFacetedFilterContext must be used within a DataTableFacetedFilter");return e},bn=({hadPreviousValue:e,label:t,value:a,readonly:r,hasOperator:i,onRemove:n})=>{const{t:u}=H(),o=d=>{d.stopPropagation(),n()};return s.jsxs("div",{className:"bg-ui-bg-field transition-fg shadow-borders-base text-ui-fg-subtle flex cursor-default select-none items-stretch overflow-hidden rounded-md",children:[!e&&s.jsx(ut,{}),s.jsx("div",{className:O("flex items-center justify-center whitespace-nowrap px-2 py-1",{"border-r":!!(a||e)}),children:s.jsx(z,{size:"small",weight:"plus",leading:"compact",children:t})}),s.jsxs("div",{className:"flex w-full items-center overflow-hidden",children:[i&&!!(a||e)&&s.jsx("div",{className:"border-r p-1 px-2",children:s.jsx(z,{size:"small",weight:"plus",leading:"compact",className:"text-ui-fg-muted",children:u("general.is")})}),!!(a||e)&&s.jsx(Ue,{asChild:!0,className:O("flex-1 cursor-pointer overflow-hidden border-r p-1 px-2",{"hover:bg-ui-bg-field-hover":!r,"data-[state=open]:bg-ui-bg-field-hover":!r}),children:s.jsx(z,{size:"small",leading:"compact",weight:"plus",className:"truncate text-nowrap",children:a||" "})})]}),!r&&!!(a||e)&&s.jsx("button",{onClick:o,className:O("text-ui-fg-muted transition-fg flex items-center justify-center p-1","hover:bg-ui-bg-subtle-hover","active:bg-ui-bg-subtle-pressed active:text-ui-fg-base"),children:s.jsx(He,{})})]})},ie=bn,mn=({filter:e,prefix:t,readonly:a,openOnMount:r})=>{const[i,n]=_.useState(r),[u,o]=_.useState(!1),{getFullDate:d}=st(),{key:c,label:f}=e,{removeFilter:v}=W(),m=se({param:c,prefix:t}),T=hn(),l=g=>{m.add(JSON.stringify(g)),o(!1)},p=()=>{m.delete(),o(g=>!g)},y=m.get(),b=xn(y),h=Ve(b,"$gte"),w=Ve(b,"$lte"),A=(g,N)=>{const F=N==="start"?"$gte":"$lte";let G=g;F==="$lte"&&g&&(G=new Date(g.getTime()),G.setHours(23,59,59,999)),m.add(JSON.stringify({...b||{},[F]:G==null?void 0:G.toISOString()}))},C=()=>{const g=T.find(N=>vn(N.value,b));return g==null?void 0:g.label},M=g=>g?d({date:g}):void 0,E=()=>[h,w].map(M).filter(Boolean).join(" - "),D=C()||E(),[B,$]=_.useState(D),P=()=>{m.delete(),v(c)};let S=null;const x=g=>{n(g),$(D),S&&clearTimeout(S),!g&&!y.length&&(S=setTimeout(()=>{v(c)},200))};return s.jsxs(K,{modal:!0,open:i,onOpenChange:x,children:[s.jsx(ie,{hadPreviousValue:!!B,label:f,value:D,onRemove:P,readonly:a}),!a&&s.jsx(q,{children:s.jsxs(J,{"data-name":"date_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout h-full max-h-[var(--radix-popper-available-height)] w-[300px] overflow-auto rounded-lg"),onInteractOutside:g=>{var N;g.target instanceof HTMLElement&&((N=g.target.attributes.getNamedItem("data-name"))==null?void 0:N.value)==="filters_menu_content"&&g.preventDefault()},children:[s.jsxs("ul",{className:"w-full p-1",children:[T.map(g=>{const N=m.get().includes(JSON.stringify(g.value));return s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:()=>{l(g.value)},children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!N}),children:s.jsx(Z,{})}),g.label]})},g.label)}),s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:p,children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!u}),children:s.jsx(Z,{})}),le("filters.date.custom")]})})]}),u&&s.jsxs("div",{className:"border-t px-1 pb-3 pt-1",children:[s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(z,{size:"xsmall",leading:"compact",weight:"plus",children:le("filters.date.from")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(xe,{modal:!0,maxValue:w,value:h,onChange:g=>A(g,"start")})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(z,{size:"xsmall",leading:"compact",weight:"plus",children:le("filters.date.to")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(xe,{modal:!0,minValue:h,value:w||void 0,onChange:g=>{A(g,"end")}})})]})]})]})})]})},L=new Date;L.setHours(0,0,0,0);var hn=()=>{const{t:e}=H();return _.useMemo(()=>[{label:e("filters.date.today"),value:{$gte:L.toISOString()}},{label:e("filters.date.lastSevenDays"),value:{$gte:new Date(L.getTime()-7*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastThirtyDays"),value:{$gte:new Date(L.getTime()-30*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastNinetyDays"),value:{$gte:new Date(L.getTime()-90*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastTwelveMonths"),value:{$gte:new Date(L.getTime()-365*24*60*60*1e3).toISOString()}}],[e])},xn=e=>e!=null&&e.length?JSON.parse(e.join(",")):null,Ve=(e,t)=>{if(!(e!=null&&e[t]))return;const a=new Date(e[t]);return t==="$lte"&&a.setHours(0,0,0,0),a},yn=({filter:e,prefix:t,readonly:a,openOnMount:r})=>{const{t:i}=H(),[n,u]=_.useState(r),{key:o,label:d}=e,{removeFilter:c}=W(),f=se({param:o,prefix:t,multiple:!1}),v=f.get(),[m,T]=_.useState(v),[l,p]=_.useState(_n(v)),y=_.useCallback(ze.debounce(($,P)=>{const S=$.target.value,x=JSON.parse((v==null?void 0:v.join(","))||"{}"),g=!isNaN(Number(x)),N=F=>{if(!S&&g){f.delete();return}if(x&&!S){delete x[F],f.add(JSON.stringify(x));return}if(!x){f.add(JSON.stringify({[F]:S}));return}f.add(JSON.stringify({...x,[F]:S}))};switch(P){case"eq":S?f.add(S):f.delete();break;case"lt":case"gt":N(P);break}},500),[f,v]);_.useEffect(()=>()=>{y.cancel()},[y]);let b=null;const h=$=>{u($),T(v),b&&clearTimeout(b),!$&&!v.length&&(b=setTimeout(()=>{c(o)},200))},w=()=>{f.delete(),c(o)},A=[{operator:"exact",label:i("filters.compare.exact")},{operator:"range",label:i("filters.compare.range")}],C=`${o}-gt`,M=`${o}-lt`,E=o,D=Be(v,i),B=Be(m,i);return s.jsxs(K,{modal:!0,open:n,onOpenChange:h,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!B,label:d,value:D,onRemove:w,readonly:a}),!a&&s.jsx(q,{children:s.jsxs(J,{"data-name":"number_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout max-h-[var(--radix-popper-available-height)] w-[300px] divide-y overflow-y-auto rounded-lg outline-none"),onInteractOutside:$=>{var P;$.target instanceof HTMLElement&&((P=$.target.attributes.getNamedItem("data-name"))==null?void 0:P.value)==="filters_menu_content"&&$.preventDefault()},children:[s.jsx("div",{className:"p-1",children:s.jsx(pt,{value:l,onValueChange:$=>p($),className:"flex flex-col items-start",orientation:"vertical",autoFocus:!0,children:A.map($=>s.jsxs(vt,{value:$.operator,className:"txt-compact-small hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-hover active:bg-ui-bg-base-pressed transition-fg grid w-full grid-cols-[20px_1fr] gap-2 rounded-[4px] px-2 py-1.5 text-left outline-none",children:[s.jsx("div",{className:"size-5",children:s.jsx(bt,{children:s.jsx(Z,{})})}),s.jsx("span",{className:"w-full",children:$.label})]},$.operator))})}),s.jsx("div",{children:l==="range"?s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:C,children:i("filters.compare.greaterThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:C,size:"small",type:"number",defaultValue:ce(v,"gt"),onChange:$=>y($,"gt")})}),s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:M,children:i("filters.compare.lessThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:M,size:"small",type:"number",defaultValue:ce(v,"lt"),onChange:$=>y($,"lt")})})]},"range"):s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:E,children:d})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:E,size:"small",type:"number",defaultValue:ce(v,"eq"),onChange:$=>y($,"eq")})})]},"exact")})]})})]})},Be=(e,t)=>{const a=JSON.parse((e==null?void 0:e.join(","))||"{}");let r="";if(typeof a=="object"){const i=[];a.gt&&i.push(t("filters.compare.greaterThanLabel",{value:a.gt})),a.lt&&i.push(t("filters.compare.lessThanLabel",{value:a.lt})),r=i.join(` ${t("filters.compare.andLabel")} `)}return typeof a=="number"&&(r=a.toString()),r},at=e=>{if(!e)return;const t=e.join(",");if(t)return JSON.parse(t)},ce=(e,t)=>{const a=at(e);if(typeof a=="object")return a[t];if(typeof a=="number"&&t==="eq")return a},_n=e=>typeof at(e)=="object"?"range":"exact",jn=({filter:e,prefix:t,readonly:a,multiple:r,searchable:i,options:n,openOnMount:u})=>{const[o,d]=_.useState(u),[c,f]=_.useState(""),[v,m]=_.useState(null),{t:T}=H(),{removeFilter:l}=W(),{key:p,label:y}=e,b=se({param:p,prefix:t,multiple:r}),h=b.get(),w=h.map(x=>{var g;return(g=n.find(N=>N.value===x))==null?void 0:g.label}).filter(Boolean),[A,C]=_.useState(w),M=()=>{b.delete(),l(p)};let E=null;const D=x=>{d(x),C(w),E&&clearTimeout(E),!x&&!h.length&&(E=setTimeout(()=>{l(p)},200))},B=()=>{f(""),v&&v.focus()},$=x=>{b.get().includes(String(x))?b.delete(String(x)):b.add(String(x))},P=w?Array.isArray(w)?w:[w]:null,S=A?Array.isArray(A)?A:[A]:null;return s.jsxs(K,{modal:!0,open:o,onOpenChange:D,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!(S!=null&&S.length),readonly:a,label:y,value:P==null?void 0:P.join(", "),onRemove:M}),!a&&s.jsx(q,{children:s.jsx(J,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:x=>{var g;x.target instanceof HTMLElement&&((g=x.target.attributes.getNamedItem("data-name"))==null?void 0:g.value)==="filters_menu_content"&&(x.preventDefault(),x.stopPropagation())},children:s.jsxs(U,{className:"h-full",children:[i&&s.jsx("div",{className:"border-b p-1",children:s.jsxs("div",{className:"grid grid-cols-[1fr_20px] gap-x-2 rounded-md px-2 py-1",children:[s.jsx(U.Input,{ref:m,value:c,onValueChange:f,className:"txt-compact-small placeholder:text-ui-fg-muted bg-transparent outline-none",placeholder:"Search"}),s.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:s.jsx("button",{disabled:!c,onClick:B,className:O("transition-fg text-ui-fg-muted focus-visible:bg-ui-bg-base-pressed rounded-md outline-none",{invisible:!c}),children:s.jsx(He,{})})})]})}),s.jsx(U.Empty,{className:"txt-compact-small flex items-center justify-center p-1",children:s.jsx("span",{className:"w-full px-2 py-1 text-center",children:T("general.noResultsTitle")})}),s.jsx(U.List,{className:"h-full max-h-[163px] min-h-[0] overflow-auto p-1 outline-none",children:n.map(x=>{const g=b.get().includes(String(x.value));return s.jsxs(U.Item,{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover aria-selected:bg-ui-bg-base-pressed focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center gap-x-2 rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",value:x.label,onSelect:()=>{$(x.value)},children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!g}),children:r?s.jsx(ot,{}):s.jsx(Z,{})}),x.label]},String(x.value))})})]})})})]})},$n=({filter:e,prefix:t,readonly:a,openOnMount:r})=>{const[i,n]=_.useState(r),{key:u,label:o}=e,{removeFilter:d}=W(),c=se({param:u,prefix:t}),f=c.get(),[v,m]=_.useState(f==null?void 0:f[0]),T=_.useCallback(ze.debounce(b=>{const h=b.target.value;h?c.add(h):c.delete()},500),[c]);_.useEffect(()=>()=>{T.cancel()},[T]);let l=null;const p=b=>{n(b),m(f==null?void 0:f[0]),l&&clearTimeout(l),!b&&!f.length&&(l=setTimeout(()=>{d(u)},200))},y=()=>{c.delete(),d(u)};return s.jsxs(K,{modal:!0,open:i,onOpenChange:p,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!v,label:o,value:f==null?void 0:f[0],onRemove:y,readonly:a}),!a&&s.jsx(q,{children:s.jsx(J,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:b=>{var h;b.target instanceof HTMLElement&&((h=b.target.attributes.getNamedItem("data-name"))==null?void 0:h.value)==="filters_menu_content"&&(b.preventDefault(),b.stopPropagation())},children:s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:u,children:o})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:u,size:"small",defaultValue:(f==null?void 0:f[0])||void 0,onChange:T})})]})})})]})},Pn=({filters:e,readonly:t,prefix:a})=>{const{t:r}=H(),[i]=Ge(),[n,u]=_.useState(!1),[o,d]=_.useState(wn({searchParams:i,filters:e,prefix:a})),c=e.filter(l=>!o.find(p=>p.key===l.key)),f=_.useRef(!0);_.useEffect(()=>{if(f.current){const l=new URLSearchParams(i);e.forEach(p=>{const y=a?`${a}_${p.key}`:p.key;l.get(y)&&!o.find(h=>h.key===p.key)&&(p.type==="select"?d(h=>[...h,{...p,multiple:p.multiple,options:p.options,openOnMount:!1}]):d(h=>[...h,{...p,openOnMount:!1}]))})}f.current=!1},[o,e,a,i]);const v=l=>{u(!1),d(p=>[...p,{...l,openOnMount:!0}])},m=_.useCallback(l=>{d(p=>p.filter(y=>y.key!==l))},[]),T=_.useCallback(()=>{d([])},[]);return s.jsx(tt.Provider,{value:_.useMemo(()=>({removeFilter:m,removeAllFilters:T}),[T,m]),children:s.jsxs("div",{className:"max-w-2/3 flex flex-wrap items-center gap-2",children:[o.map(l=>{switch(l.type){case"select":return s.jsx(jn,{filter:l,prefix:a,readonly:t,options:l.options,multiple:l.multiple,searchable:l.searchable,openOnMount:l.openOnMount},l.key);case"date":return s.jsx(mn,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key);case"string":return s.jsx($n,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key);case"number":return s.jsx(yn,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key)}}),!t&&c.length>0&&s.jsxs(K,{modal:!0,open:n,onOpenChange:u,children:[s.jsx(Ue,{asChild:!0,id:"filters_menu_trigger",children:s.jsx(lt,{size:"small",variant:"secondary",children:r("filters.addFilter")})}),s.jsx(q,{children:s.jsx(J,{className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-auto rounded-lg p-1 outline-none"),"data-name":"filters_menu_content",align:"start",sideOffset:8,collisionPadding:8,onCloseAutoFocus:l=>{o.find(y=>y.openOnMount)&&l.preventDefault()},children:c.map(l=>s.jsx("div",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",role:"menuitem",onClick:()=>{v(l)},children:l.label},l.key))})})]}),!t&&o.length>0&&s.jsx(Tn,{filters:e,prefix:a})]})})},Tn=({filters:e,prefix:t})=>{const{removeAllFilters:a}=W(),[r,i]=Ge(),n=()=>{i(u=>{const o=new URLSearchParams(u);return e.forEach(d=>{o.delete(t?`${t}_${d.key}`:d.key)}),o}),a()};return s.jsx("button",{type:"button",onClick:n,className:O("text-ui-fg-muted transition-fg txt-compact-small-plus rounded-md px-2 py-1","hover:text-ui-fg-subtle","focus-visible:shadow-borders-focus"),children:"Clear all"})},wn=({searchParams:e,filters:t,prefix:a})=>{const r=new URLSearchParams(e),i=[];return t.forEach(n=>{const u=a?`${a}_${n.key}`:n.key;r.get(u)&&(n.type==="select"?i.push({...n,multiple:n.multiple,options:n.options,openOnMount:!1}):i.push({...n,openOnMount:!1}))}),i};export{Pn as D};
