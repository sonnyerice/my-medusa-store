import{C as z}from"./chunk-SCBXRJPV-AI8UlmCG.js";import{C as B}from"./chunk-2PMSBTXI-BwxFu_r2.js";import{o as y}from"./chunk-ZQRKUG6J-CsEIDNEM.js";import{t as K,a as b}from"./chunk-3ISBJK7K-BPFEXhG7.js";import{K as R}from"./chunk-6HTZNHPT-HMNXWHVt.js";import{b as m,u as T}from"./chunk-4TC5YS65-BRAnZnco.js";import{ae as Q,ag as h,ah as v,aj as U,d as $,b as k,$ as O,ab as A,ak as G,_ as J,j as e,H as _,q as F,al as W,am as X,an as Y,t as E,y as r,z as c,D as L,ao as I,B as P,ap as Z,s as ee}from"./index-BfncdA6x.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";var re=Q({title:h().min(1),material:h().optional(),sku:h().optional(),ean:h().optional(),upc:h().optional(),barcode:h().optional(),manage_inventory:v(),allow_backorder:v(),weight:y,height:y,width:y,length:y,mid_code:h().optional(),hs_code:h().optional(),origin_country:h().optional(),options:U(h())}),se=({variant:n,product:x})=>{var f,p;const{t:o}=k(),{handleSuccess:g}=T(),j=(f=x.options)==null?void 0:f.reduce((s,i)=>{var d;const a=(d=n.options)==null?void 0:d.find(u=>u.option_id===i.id);return s[i.title]=a==null?void 0:a.value,s},{}),t=W({defaultValues:{title:n.title||"",material:n.material||"",sku:n.sku||"",ean:n.ean||"",upc:n.upc||"",barcode:n.barcode||"",manage_inventory:n.manage_inventory||!1,allow_backorder:n.allow_backorder||!1,weight:n.weight||"",height:n.height||"",width:n.width||"",length:n.length||"",mid_code:n.mid_code||"",hs_code:n.hs_code||"",origin_country:n.origin_country||"",options:j},resolver:X(re)}),{mutateAsync:l,isPending:w}=Y(n.product_id,n.id),C=t.handleSubmit(async s=>{const{title:i,weight:a,height:d,width:u,length:M,allow_backorder:N,manage_inventory:V,options:S,...D}=s,q=K(D);await l({id:n.id,weight:b(a),height:b(d),width:b(u),length:b(M),title:i,allow_backorder:N,manage_inventory:V,options:S,...q},{onSuccess:()=>{g("../"),E.success(o("products.variant.edit.success"))},onError:H=>{E.error(H.message)}})});return e.jsx(m.Form,{form:t,children:e.jsxs(R,{onSubmit:C,className:"flex size-full flex-col overflow-hidden",children:[e.jsxs(m.Body,{className:"flex size-full flex-col gap-y-8 overflow-auto",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:t.control,name:"title",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:o("fields.title")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"material",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.material")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),(p=x.options)==null?void 0:p.map(s=>e.jsx(r.Field,{control:t.control,name:`options.${s.title}`,render:({field:{value:i,onChange:a,...d}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s.title}),e.jsx(r.Control,{children:e.jsx(B,{value:i,onChange:u=>{a(u)},...d,options:s.values.map(u=>({label:u.value,value:u.value}))})})]})},s.id))]}),e.jsx(L,{}),e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(_,{level:"h2",children:o("products.variant.inventory.header")}),e.jsx(r.Field,{control:t.control,name:"sku",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.sku")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"ean",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.ean")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"upc",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.upc")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"barcode",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.barcode")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(r.Field,{control:t.control,name:"manage_inventory",render:({field:{value:s,onChange:i,...a}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:o("products.variant.inventory.manageInventoryLabel")}),e.jsx(r.Control,{children:e.jsx(I,{checked:s,onCheckedChange:d=>i(!!d),...a})})]}),e.jsx(r.Hint,{children:o("products.variant.inventory.manageInventoryHint")})]}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"allow_backorder",render:({field:{value:s,onChange:i,...a}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:o("products.variant.inventory.allowBackordersLabel")}),e.jsx(r.Control,{children:e.jsx(I,{checked:s,onCheckedChange:d=>i(!!d),...a})})]}),e.jsx(r.Hint,{children:o("products.variant.inventory.allowBackordersHint")})]}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(L,{}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(_,{level:"h2",children:o("products.attributes")}),e.jsx(r.Field,{control:t.control,name:"weight",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.weight")}),e.jsx(r.Control,{children:e.jsx(c,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"width",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.width")}),e.jsx(r.Control,{children:e.jsx(c,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"length",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.length")}),e.jsx(r.Control,{children:e.jsx(c,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"height",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.height")}),e.jsx(r.Control,{children:e.jsx(c,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"mid_code",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.midCode")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"hs_code",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.hsCode")}),e.jsx(r.Control,{children:e.jsx(c,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"origin_country",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:o("fields.countryOfOrigin")}),e.jsx(r.Control,{children:e.jsx(z,{...s})}),e.jsx(r.ErrorMessage,{})]})})]})]}),e.jsx(m.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(m.Close,{asChild:!0,children:e.jsx(P,{variant:"secondary",size:"small",children:o("actions.cancel")})}),e.jsx(P,{type:"submit",size:"small",isLoading:w,children:o("actions.save")})]})})]})})},ue=()=>{const n=$(),{t:x}=k(),{id:o,variant_id:g}=O(),[j]=A(),t=j.get("variant_id"),{variant:l,isPending:w,isError:C,error:f}=G(o,g||t,void 0,{initialData:n}),{product:p,isPending:s,isError:i,error:a}=J(l==null?void 0:l.product_id,{fields:"-variants"},{enabled:!!(l!=null&&l.product_id)}),d=!w&&!!l&&!s&&!!p;if(C)throw f;if(i)throw a;return e.jsxs(m,{children:[e.jsx(m.Header,{children:e.jsx(_,{children:x("products.variant.edit.header")})}),d&&e.jsx(se,{variant:l,product:p})]})},ne=async(n,x)=>await ee.admin.product.retrieveVariant(n,x),oe=(n,x)=>({queryKey:Z.detail(x),queryFn:async()=>ne(n,x)}),je=async({params:n,request:x})=>{const o=n.id,j=new URL(x.url).searchParams.get("variant_id"),t=n.variant_id||j,l=oe(o,t||j);return F.getQueryData(l.queryKey)??await F.fetchQuery(l)};export{ue as Component,je as loader};
