import{f as S}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{C as F}from"./chunk-2PMSBTXI-D-bGks_a.js";import{c as N}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{K as T}from"./chunk-6HTZNHPT-DfZIDBnp.js";import{b as l,u as I}from"./chunk-4TC5YS65-nGK-y6kq.js";import{a2 as H,a4 as v,ad as M,a5 as y,b as P,R as k,e4 as z,g as U,l as B,j as e,H as V,a8 as K,e6 as A,t as b,w as s,x as D,ab as C,T as E,B as w}from"./index-CzNfOyID.js";import{b as q}from"./chunk-F3G43K3W-DN8bnDX_.js";import{S as u}from"./select-KO8A0rQ7.js";import"./x-mark-mini-C21_Uzye.js";import"./triangles-mini-BMGfOEBt.js";import"./plus-mini-D3SBtq5M.js";import"./prompt-DreUfdsh.js";import"./check-zy__dwvs.js";H({name:v().min(1),currency_code:v(),payment_providers:M(v()),automatic_taxes:y(),is_tax_inclusive:y()});var G=({region:a,currencies:j,paymentProviders:d,pricePreferences:m})=>{var h;const{t:i}=P(),{handleSuccess:p}=I(),t=m==null?void 0:m.find(r=>r.attribute==="region_id"&&r.value===a.id),o=K({defaultValues:{name:a.name,currency_code:a.currency_code.toUpperCase(),payment_providers:((h=a.payment_providers)==null?void 0:h.map(r=>r.id))||[],automatic_taxes:a.automatic_taxes,is_tax_inclusive:(t==null?void 0:t.is_tax_inclusive)||!1}}),{mutateAsync:f,isPending:g}=A(a.id),_=o.handleSubmit(async r=>{await f({name:r.name,automatic_taxes:r.automatic_taxes,currency_code:r.currency_code.toLowerCase(),payment_providers:r.payment_providers,is_tax_inclusive:r.is_tax_inclusive},{onSuccess:()=>{b.success(i("regions.toast.edit")),p()},onError:n=>{b.error(n.message)}})});return e.jsx(l.Form,{form:o,children:e.jsxs(T,{onSubmit:_,className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(l.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:o.control,name:"name",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.name")}),e.jsx(s.Control,{children:e.jsx(D,{...r})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:o.control,name:"currency_code",render:({field:{onChange:r,ref:n,...c}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.currency")}),e.jsx(s.Control,{children:e.jsxs(u,{onValueChange:r,...c,children:[e.jsx(u.Trigger,{ref:n,children:e.jsx(u.Value,{})}),e.jsx(u.Content,{children:j.map(x=>e.jsx(u.Item,{value:x.code,children:x.code.toUpperCase()},x.code))})]})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:o.control,name:"automatic_taxes",render:({field:{value:r,onChange:n,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.automaticTaxes")}),e.jsx(s.Control,{children:e.jsx(C,{...c,checked:r,onCheckedChange:n})})]}),e.jsx(s.Hint,{children:i("regions.automaticTaxesHint")}),e.jsx(s.ErrorMessage,{})]})})}),e.jsx(s.Field,{control:o.control,name:"is_tax_inclusive",render:({field:{value:r,onChange:n,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.taxInclusivePricing")}),e.jsx(s.Control,{children:e.jsx(C,{...c,checked:r,onCheckedChange:n})})]}),e.jsx(s.Hint,{children:i("regions.taxInclusiveHint")}),e.jsx(s.ErrorMessage,{})]})})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{size:"small",leading:"compact",weight:"plus",children:"Providers"}),e.jsx(E,{size:"small",className:"text-ui-fg-subtle",children:i("regions.providersHint")})]}),e.jsx(s.Field,{control:o.control,name:"payment_providers",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.paymentProviders")}),e.jsx(s.Control,{children:e.jsx(F,{options:d.map(n=>({label:S(n.id),value:n.id})),...r})}),e.jsx(s.ErrorMessage,{})]})})]})]})}),e.jsx(l.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(w,{size:"small",variant:"secondary",children:i("actions.cancel")})}),e.jsx(w,{size:"small",type:"submit",isLoading:g,children:i("actions.save")})]})})]})})},oe=()=>{const{t:a}=P(),{id:j}=k(),{region:d,isPending:m,isError:i,error:p}=z(j,{fields:"*payment_providers,*countries,+automatic_taxes"}),{store:t,isPending:o,isError:f,error:g}=U(),{price_preferences:_=[],isPending:h,isError:r,error:n}=B({attribute:"region_id",value:j},{enabled:!!d}),c=m||o||h,x=((t==null?void 0:t.supported_currencies)??[]).map(L=>N[L.currency_code.toUpperCase()]),{payment_providers:R=[]}=q({limit:999,is_enabled:!0});if(i)throw p;if(f)throw g;if(r)throw n;return e.jsxs(l,{children:[e.jsx(l.Header,{children:e.jsx(V,{children:a("regions.editRegion")})}),!c&&d&&e.jsx(G,{region:d,currencies:x,paymentProviders:R,pricePreferences:_})]})};export{oe as Component};
